<!doctype html><html class=no-js lang=cn>
<head>
<meta charset=utf-8>
<link rel=preload href=https://qiaomingzi.github.io/fonts/muli-latin-200.woff2 as=font type=font/woff2 crossorigin>
<link rel=preload href=https://qiaomingzi.github.io/fonts/muli-latin-400.woff2 as=font type=font/woff2 crossorigin>
<link rel=preload href=https://qiaomingzi.github.io/fonts/muli-latin-800.woff2 as=font type=font/woff2 crossorigin>
<meta http-equiv=X-UA-Compatible content="IE=edge">
<title>
mysql master-slave | 李明梓
</title>
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=generator content="Hugo 0.125.0">
<meta name=robots content="index, follow">
<link rel=stylesheet href=/output/css/app.min.f5631eeeca4e467026e4115898af115d1dda1767791c22841d02b8a556b2ad5c.css integrity="sha256-9WMe7spORnAm5BFYmK8RXR3aF2d5HCKEHQK4pVayrVw=" crossorigin=anonymous>
<meta name=description content="
        李明梓个人站点
      
      ">
<script type=text/javascript src=/output/js/app.d805ae0639aa4bf4b35f1863e219243d6a79b910625d8f0be3664db006b4ce6f.js integrity="sha256-2AWuBjmqS/SzXxhj4hkkPWp5uRBiXY8L42ZNsAa0zm8=" crossorigin=anonymous defer></script>
<script async defer src=https://buttons.github.io/buttons.js></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png>
<link rel=icon type=image/png href=/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/favicon-16x16.png sizes=16x16>
<link rel=manifest href=/manifest.json>
<link rel=mask-icon href=/safari-pinned-tab.svg color=#0594cb>
<meta name=theme-color content="#ffffff">
<meta property="og:title" content="mysql master-slave">
<meta property="og:description" content="1.参考 【mysql8.0手册】https://dev.mysql.com/doc/refman/8.0/en/
【mysql doc】https://dev.mysql.com/doc/
【alibaba canal】https://github.com/alibaba/canal
2.概要 通过本文可以了解主从同步原理，快速搭建一个主从环境,实现复制场景，并且利用canal实现订阅binglog日志，实现跨实例同步。
中间件版本:
mysql-8.0.27
canal 1.1.5
3.主从同步 创建容错系统的最常见方法就是冗余，复制模式分普通复制、组复制，普通复制即传统的 MySQL复制 提供了一种简单的源(mater)到副本复制方法,。
master-slave syn MySQL 复制功能允许服务器 -主服务器 - 将所有更改发送到另一台服务器 -从服务器 -从服务器尝试应用所有更改以与主服务器保持同步。复制工作如下：
每当 master 的数据库被修改时，更改都会写入一个文件，即所谓的二进制日志或binlog。这是由执行修改数据库的查询的客户端线程完成的。
master 有一个线程，称为dump thread，它不断读取 master 的 binlog 并将其发送给 slave。
slave有一个线程，称为IO线程，它接收master的dump线程发送的binlog，并将其写入一个文件： relay log，show variables like &lsquo;%relay%&rsquo;。
从服务器有另一个线程，称为 SQL 线程，它不断读取中继日志并将更改应用到从服务器。
MySQL 复制功能使用三个主线程实现，一个在源服务器上，两个在副本上：
二进制日志转储线程。 当副本连接时，源创建一个线程将二进制日志内容发送到副本。该线程可以SHOW PROCESSLIST在源上的输出中标识为Binlog Dump线程。
二进制日志转储线程获取源二进制日志的锁，用于读取要发送到副本的每个事件。一旦事件被读取，锁就会被释放，甚至在事件被发送到副本之前。
复制 I/O 接收器线程。 当START REPLICA在副本服务器上发出一条语句时，副本会创建一个 I/O（接收器）线程，该线程连接到源并要求它发送记录在其二进制日志中的更新。
复制接收者线程读取源Binlog Dump线程发送的更新（参见上一项）并将它们复制到包含副本中继日志的本地文件。
该线程的状态显示 Slave_IO_running在 的输出中 SHOW SLAVE STATUS。
复制 SQL 应用程序线程。 副本创建一个 SQL（应用程序）线程来读取由复制接收器线程写入的中继日志并执行其中包含的事务。">
<meta property="og:type" content="article">
<meta property="og:url" content="https://qiaomingzi.github.io/cn/article/db/mysql-master-slave/"><meta property="og:image" content="https://qiaomingzi.github.io/opengraph/gohugoio-card-base-1_huf001e7df4fd9c00c4355abac7d4ca455_242906_filter_2880938809998166293.png"><meta property="article:section" content="cn">
<meta property="article:published_time" content="2021-10-16T15:42:33+08:00">
<meta property="article:modified_time" content="2024-06-26T22:21:17+08:00">
<meta itemprop=name content="mysql master-slave">
<meta itemprop=description content="1.参考 【mysql8.0手册】https://dev.mysql.com/doc/refman/8.0/en/
【mysql doc】https://dev.mysql.com/doc/
【alibaba canal】https://github.com/alibaba/canal
2.概要 通过本文可以了解主从同步原理，快速搭建一个主从环境,实现复制场景，并且利用canal实现订阅binglog日志，实现跨实例同步。
中间件版本:
mysql-8.0.27
canal 1.1.5
3.主从同步 创建容错系统的最常见方法就是冗余，复制模式分普通复制、组复制，普通复制即传统的 MySQL复制 提供了一种简单的源(mater)到副本复制方法,。
master-slave syn MySQL 复制功能允许服务器 -主服务器 - 将所有更改发送到另一台服务器 -从服务器 -从服务器尝试应用所有更改以与主服务器保持同步。复制工作如下：
每当 master 的数据库被修改时，更改都会写入一个文件，即所谓的二进制日志或binlog。这是由执行修改数据库的查询的客户端线程完成的。
master 有一个线程，称为dump thread，它不断读取 master 的 binlog 并将其发送给 slave。
slave有一个线程，称为IO线程，它接收master的dump线程发送的binlog，并将其写入一个文件： relay log，show variables like &lsquo;%relay%&rsquo;。
从服务器有另一个线程，称为 SQL 线程，它不断读取中继日志并将更改应用到从服务器。
MySQL 复制功能使用三个主线程实现，一个在源服务器上，两个在副本上：
二进制日志转储线程。 当副本连接时，源创建一个线程将二进制日志内容发送到副本。该线程可以SHOW PROCESSLIST在源上的输出中标识为Binlog Dump线程。
二进制日志转储线程获取源二进制日志的锁，用于读取要发送到副本的每个事件。一旦事件被读取，锁就会被释放，甚至在事件被发送到副本之前。
复制 I/O 接收器线程。 当START REPLICA在副本服务器上发出一条语句时，副本会创建一个 I/O（接收器）线程，该线程连接到源并要求它发送记录在其二进制日志中的更新。
复制接收者线程读取源Binlog Dump线程发送的更新（参见上一项）并将它们复制到包含副本中继日志的本地文件。
该线程的状态显示 Slave_IO_running在 的输出中 SHOW SLAVE STATUS。
复制 SQL 应用程序线程。 副本创建一个 SQL（应用程序）线程来读取由复制接收器线程写入的中继日志并执行其中包含的事务。">
<meta itemprop=datePublished content="2021-10-16T15:42:33+08:00">
<meta itemprop=dateModified content="2024-06-26T22:21:17+08:00">
<meta itemprop=wordCount content="896">
<meta itemprop=image content="https://qiaomingzi.github.io/images/gohugoio-card.png">
<meta itemprop=keywords content="Mysql"><meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://qiaomingzi.github.io/opengraph/gohugoio-card-base-1_huf001e7df4fd9c00c4355abac7d4ca455_242906_filter_2880938809998166293.png">
<meta name=twitter:title content="mysql master-slave">
<meta name=twitter:description content="1.参考 【mysql8.0手册】https://dev.mysql.com/doc/refman/8.0/en/
【mysql doc】https://dev.mysql.com/doc/
【alibaba canal】https://github.com/alibaba/canal
2.概要 通过本文可以了解主从同步原理，快速搭建一个主从环境,实现复制场景，并且利用canal实现订阅binglog日志，实现跨实例同步。
中间件版本:
mysql-8.0.27
canal 1.1.5
3.主从同步 创建容错系统的最常见方法就是冗余，复制模式分普通复制、组复制，普通复制即传统的 MySQL复制 提供了一种简单的源(mater)到副本复制方法,。
master-slave syn MySQL 复制功能允许服务器 -主服务器 - 将所有更改发送到另一台服务器 -从服务器 -从服务器尝试应用所有更改以与主服务器保持同步。复制工作如下：
每当 master 的数据库被修改时，更改都会写入一个文件，即所谓的二进制日志或binlog。这是由执行修改数据库的查询的客户端线程完成的。
master 有一个线程，称为dump thread，它不断读取 master 的 binlog 并将其发送给 slave。
slave有一个线程，称为IO线程，它接收master的dump线程发送的binlog，并将其写入一个文件： relay log，show variables like &lsquo;%relay%&rsquo;。
从服务器有另一个线程，称为 SQL 线程，它不断读取中继日志并将更改应用到从服务器。
MySQL 复制功能使用三个主线程实现，一个在源服务器上，两个在副本上：
二进制日志转储线程。 当副本连接时，源创建一个线程将二进制日志内容发送到副本。该线程可以SHOW PROCESSLIST在源上的输出中标识为Binlog Dump线程。
二进制日志转储线程获取源二进制日志的锁，用于读取要发送到副本的每个事件。一旦事件被读取，锁就会被释放，甚至在事件被发送到副本之前。
复制 I/O 接收器线程。 当START REPLICA在副本服务器上发出一条语句时，副本会创建一个 I/O（接收器）线程，该线程连接到源并要求它发送记录在其二进制日志中的更新。
复制接收者线程读取源Binlog Dump线程发送的更新（参见上一项）并将它们复制到包含副本中继日志的本地文件。
该线程的状态显示 Slave_IO_running在 的输出中 SHOW SLAVE STATUS。
复制 SQL 应用程序线程。 副本创建一个 SQL（应用程序）线程来读取由复制接收器线程写入的中继日志并执行其中包含的事务。">
<script async src="https://www.googletagmanager.com/gtag/js?id=245212315af876cae36fd6880abbfa41"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","245212315af876cae36fd6880abbfa41",{anonymize_ip:!0,dimension1:"qiaomingzi.github.io",dimension2:""});var trackOutboundLink=function(e){gtag("event","click",{event_category:"outbound",event_label:e,transport_type:"beacon"})}</script>
</head>
<body class="ma0 sans-serif bg-primary-color-light">
<nav class="bg-primary-color-dark pv4 w-100" role=navigation>
<div class="center flex-ns flex-wrap items-center justify-start mw9">
<h1 class="dim f3 lh-solid ml0-ns mr0 mr4-l mv0 pl3 pl4-ns">
<a href=javascript:void(0); class="link white">
李明梓
</a>
</h1>
<div class="db dib-ns pl3"><form id=site-search-form role=search>
<fieldset class="bn ma0 pa0">
<label class=clip for=search-input>Search</label>
<input type=search id=search-input class="needs-js bg-left bn f5 input-reset lh-solid mt3 mt0-ns pl4 pv2 w5 white" placeholder="Search the Docs" name=search-input style="background:url(/images/icon-search.png)5px 11px/16px 16px no-repeat;background-color:rgba(255,255,255,0)">
</fieldset>
</form>
</div>
<ul class="list ma0 pa0 dn dib-l" role=menu>
<li class="f5 dib mr4" role=menuitem>
<a href=https://qiaomingzi.github.io/ class="dim link light-silver">
首页
</a>
</li>
<li class="f5 dib mr4" role=menuitem>
<a href=/article/documentation/ class="dim link light-silver">
文档
</a>
</li>
<li class="f5 dib mr4" role=menuitem>
<a href=/about/ class="dim link light-silver">
关于我
</a>
</li>
</ul>
<div class="absolute mt1 mt2-l pr3 right-0 top-0 flex items-start">
<a class="github-button needs-js link primary-color-dark" href=https://github.com/qiaomingzi data-size=large data-show-count=false aria-label="Star gohugoio/hugo on GitHub">Star</a>
</div>
</div>
</nav>
<main role=main class="content-with-sidebar min-vh-100 pb7 pb0-ns">
<article class="w-100 ph4 pb5 pb6-ns pt1 pt5-ns">
<div class=flex-l>
<div class="order-0 w-20 dn db-l">
<nav role=navigation>
<ul class="list pa0 nl2">
<li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8">
<a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.bigdata>bigdata</a>
<ul class="bigdata desktopmenu animated fadeIn list pl0 bg-light-gray dn">
<li class="f6 fw4">
<a href=/article/bigdata/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
bigdata
</a>
</li>
<li class="f6 fw4">
<a href=/article/bigdata/%E8%AF%BB%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%AE%9E%E6%88%9845%E8%AE%B2/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
读[数据分析实战45讲]
</a>
</li>
</ul>
</li>
<li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8">
<a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.go>go</a>
<ul class="go desktopmenu animated fadeIn list pl0 bg-light-gray dn">
<li class="f6 fw4">
<a href=/article/go/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
go
</a>
</li>
<li class="f6 fw4">
<a href=/article/go/go-sdk/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
GO SDK
</a>
</li>
<li class="f6 fw4">
<a href=/article/go/k8s/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
K8S
</a>
</li>
<li class="f6 fw4">
<a href=/article/go/go%E8%AF%AD%E8%A8%80%E6%A0%B8%E5%BF%8336%E8%AE%B2/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
读[GO语言核心36讲]
</a>
</li>
<li class="f6 fw4">
<a href=/article/go/go%E8%AF%AD%E8%A8%80%E7%BC%96%E7%A8%8B/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
读[GO语言编程]
</a>
</li>
</ul>
</li>
<li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8">
<a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.JAVA>JAVA</a>
<ul class="JAVA desktopmenu animated fadeIn list pl0 bg-light-gray dn">
<li class="f6 fw4">
<a href=/article/java/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
JAVA
</a>
</li>
<li class="f6 fw4">
<a href=/article/java/maven/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
maven-wrapper基础使用
</a>
</li>
<li class="f6 fw4">
<a href=/article/java/%E4%BD%8D%E8%BF%90%E7%AE%97/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
位运算基础知识
</a>
</li>
</ul>
</li>
<li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8">
<a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.python>python</a>
<ul class="python desktopmenu animated fadeIn list pl0 bg-light-gray dn">
<li class="f6 fw4">
<a href=/article/python/python%E5%9F%BA%E7%A1%80/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
python基础
</a>
</li>
</ul>
</li>
<li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8">
<a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.DB>DB</a>
<ul class="DB desktopmenu animated fadeIn list pl0 bg-light-gray dn">
<li class="f6 fw4">
<a href=/article/db/canal/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
canal-mysql binlog日志解析
</a>
</li>
<li class="f6 fw4">
<a href=/article/db/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
db
</a>
</li>
<li class="f6 fw4">
<a href=/article/db/mysql-master-slave/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
mysql master-slave
</a>
</li>
</ul>
</li>
<li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8 mb1 bb b--moon-gray">
<a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.ai>ai</a>
<ul class="ai desktopmenu animated fadeIn list pl0 bg-light-gray dn">
<li class="f6 fw4">
<a href=/article/ai/ai-agent/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
gpt-agent
</a>
</li>
</ul>
</li>
<li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8">
<a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.读书>读书</a>
<ul class="读书 desktopmenu animated fadeIn list pl0 bg-light-gray dn">
<li class="f6 fw4">
<a href=/article/%E8%AF%BB%E4%B9%A6/%E5%A4%A7%E9%A3%8E%E6%AD%8C/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
&lt;&lt;大风歌>>王立群
</a>
</li>
<li class="f6 fw4">
<a href=/article/%E8%AF%BB%E4%B9%A6/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
概览
</a>
</li>
<li class="f6 fw4">
<a href=/article/%E8%AF%BB%E4%B9%A6/%E9%AB%98%E7%BA%A7%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86%E5%B8%88/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
高级信息系统项目管理师
</a>
</li>
</ul>
</li>
<li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8">
<a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.工具>工具</a>
<ul class="工具 desktopmenu animated fadeIn list pl0 bg-light-gray dn">
<li class="f6 fw4">
<a href=/article/%E5%B7%A5%E5%85%B7/jemeter/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
jemeter基本使用
</a>
</li>
<li class="f6 fw4">
<a href=/article/%E5%B7%A5%E5%85%B7/sonarqube/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
sonarqube基础使用
</a>
</li>
<li class="f6 fw4">
<a href=/article/%E5%B7%A5%E5%85%B7/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
工具
</a>
</li>
</ul>
</li>
<li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8">
<a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.数学>数学</a>
<ul class="数学 desktopmenu animated fadeIn list pl0 bg-light-gray dn">
<li class="f6 fw4">
<a href=/article/%E6%95%B0%E5%AD%A6/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
math
</a>
</li>
<li class="f6 fw4">
<a href=/article/%E6%95%B0%E5%AD%A6/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
数学基础概念
</a>
</li>
</ul>
</li>
<li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8">
<a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.英语>英语</a>
<ul class="英语 desktopmenu animated fadeIn list pl0 bg-light-gray dn">
<li class="f6 fw4">
<a href=/article/%E8%8B%B1%E8%AF%AD/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
english
</a>
</li>
<li class="f6 fw4">
<a href=/article/%E8%8B%B1%E8%AF%AD/%E8%87%AA%E7%84%B6%E6%8B%BC%E8%AF%BB/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
英语自然拼读
</a>
</li>
<li class="f6 fw4">
<a href=/article/%E8%8B%B1%E8%AF%AD/%E9%9F%B3%E8%8A%82%E5%88%92%E5%88%86/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
英语音节划分
</a>
</li>
</ul>
</li>
<li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8">
<a href=javascript:void(0) class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.其他>其他</a>
<ul class="其他 desktopmenu animated fadeIn list pl0 bg-light-gray dn">
<li class="f6 fw4">
<a href=/article/%E5%85%B6%E4%BB%96/hexo%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
Hexo基础使用
</a>
</li>
<li class="f6 fw4">
<a href=/article/%E5%85%B6%E4%BB%96/hugo%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
Hugo基本使用
</a>
</li>
<li class="f6 fw4">
<a href=/article/%E5%85%B6%E4%BB%96/markdown%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
Markdown基本使用
</a>
</li>
<li class="f6 fw4">
<a href=/article/%E5%85%B6%E4%BB%96/yarn%E7%9B%B8%E5%85%B3/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
Yarn相关
</a>
</li>
<li class="f6 fw4">
<a href=/article/%E5%85%B6%E4%BB%96/%E5%A3%B0%E5%8D%A1/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
关于调音声卡
</a>
</li>
<li class="f6 fw4">
<a href=/article/%E5%85%B6%E4%BB%96/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
其他
</a>
</li>
<li class="f6 fw4">
<a href=/article/%E5%85%B6%E4%BB%96/%E5%BC%80%E6%BA%90%E7%9B%91%E6%8E%A7%E8%BD%AF%E4%BB%B6%E5%AF%B9%E6%AF%94_zabbix/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
开源监控软件对比_zabbix
</a>
</li>
<li class="f6 fw4">
<a href=/article/%E5%85%B6%E4%BB%96/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE%E7%B4%A2%E5%BC%95/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
开源项目索引
</a>
</li>
<li class="f6 fw4">
<a href=/article/%E5%85%B6%E4%BB%96/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F30%E5%88%86%E9%92%9F%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/ class="db link hover-bg-gray hover-white pl3 pr2 pv2 black">
正则表达式30分钟入门教程
</a>
</li>
</ul>
</li>
<li class="f5 w-100 hover-bg-light-gray hover-accent-color-light fw8">
<a href=/sources/ class="js-toggle dib w-100 link mid-gray hover-accent-color-light pl2 pr2 pv2" data-target=.sources>源码探究</a>
</li>
</ul>
</nav>
</div>
<div class="order-1 flex-grow-1 ph0 ph5-ns mt0-ns mid-gray nested-copy-line-height no-underline nested-links nested-img nested-copy-seperator nested-blockquote">
<div style=max-width:40rem class=documentation-copy>
<div id=readout class="fixed right-0 bottom-0"></div>
<header class="flex-none w-100">
<a href=/categories/mysql class="f6 fw8 mb0 link mid-gray dim mr3">
MYSQL
</a>
<h1 class="lh-title mb3 mv0 pt3 primary-color-dark">
mysql master-slave
</h1>
</header>
<aside class="bt bw1 pt3 mt2 mid-gray b--mid-gray fn w-100">
</aside>
<div class=prose id=prose>
<div class=mb4></div>
<h3 id=1参考>1.参考 <a class=header-link href=#1%e5%8f%82%e8%80%83><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3>
<p>【mysql8.0手册】https://dev.mysql.com/doc/refman/8.0/en/</p>
<p>【mysql doc】https://dev.mysql.com/doc/</p>
<p>【alibaba canal】https://github.com/alibaba/canal</p>
<h3 id=2概要>2.概要 <a class=header-link href=#2%e6%a6%82%e8%a6%81><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3>
<p>通过本文可以了解主从同步原理，快速搭建一个主从环境,实现复制场景，并且利用canal实现订阅binglog日志，实现跨实例同步。</p>
<p>中间件版本:</p>
<p>mysql-8.0.27</p>
<p>canal 1.1.5</p>
<h3 id=3主从同步>3.主从同步 <a class=header-link href=#3%e4%b8%bb%e4%bb%8e%e5%90%8c%e6%ad%a5><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3>
<p>创建容错系统的最常见方法就是冗余，复制模式分普通复制、组复制，普通复制即传统的 MySQL复制 提供了一种简单的源(mater)到副本复制方法,。</p>
<h4 id=master-slave-syn>master-slave syn <a class=header-link href=#master-slave-syn><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4>
<p><img src=/article/db/mysql-master-slave/3.jpg></p>
<p>MySQL 复制功能允许服务器 -<strong>主</strong>服务器 - 将所有更改发送到另一台服务器 -<strong>从</strong>服务器 -<strong>从</strong>服务器尝试应用所有更改以与主服务器保持同步。复制工作如下：</p>
<ul>
<li>
<p>每当 master 的数据库被修改时，更改都会写入一个文件，即所谓的<strong>二进制日志</strong>或<strong>binlog</strong>。这是由执行修改数据库的查询的客户端线程完成的。</p>
</li>
<li>
<p>master 有一个线程，称为<strong>dump thread</strong>，它不断读取 master 的 binlog 并将其发送给 slave。</p>
</li>
<li>
<p>slave有一个线程，称为<strong>IO线程</strong>，它接收master的dump线程发送的binlog，并将其写入一个文件： <strong>relay log</strong>，show variables like &lsquo;%relay%&rsquo;。</p>
</li>
<li>
<p>从服务器有另一个线程，称为 <strong>SQL 线程</strong>，它不断读取中继日志并将更改应用到从服务器。</p>
</li>
</ul>
<p>MySQL 复制功能使用三个主线程实现，一个在源服务器上，两个在副本上：</p>
<ul>
<li>
<p><strong>二进制日志转储线程。</strong> 当副本连接时，源创建一个线程将二进制日志内容发送到副本。该线程可以<a href=https://dev.mysql.com/doc/refman/8.0/en/show-processlist.html rel=external><code>SHOW PROCESSLIST</code></a>在源上的输出中标识为<code>Binlog Dump</code>线程。</p>
<p>二进制日志转储线程获取源二进制日志的锁，用于读取要发送到副本的每个事件。一旦事件被读取，锁就会被释放，甚至在事件被发送到副本之前。</p>
</li>
<li>
<p><strong>复制 I/O 接收器线程。</strong> 当<a href=https://dev.mysql.com/doc/refman/8.0/en/start-replica.html rel=external><code>START REPLICA</code></a>在副本服务器上发出一条语句时，副本会创建一个 I/O（接收器）线程，该线程连接到源并要求它发送记录在其二进制日志中的更新。</p>
<p>复制接收者线程读取源<code>Binlog Dump</code>线程发送的更新（参见上一项）并将它们复制到包含副本中继日志的本地文件。</p>
<p>该线程的状态显示 <code>Slave_IO_running</code>在 的输出中 <a href=https://dev.mysql.com/doc/refman/8.0/en/show-slave-status.html rel=external><code>SHOW SLAVE STATUS</code></a>。</p>
</li>
<li>
<p><strong>复制 SQL 应用程序线程。</strong> 副本创建一个 SQL（应用程序）线程来读取由复制接收器线程写入的中继日志并执行其中包含的事务。</p>
</li>
</ul>
<h5 id=异步复制>异步复制</h5>
<p><img src=./async-replication-diagram.png></p>
<h5 id=半同步复制>半同步复制</h5>
<p><img src=./semisync-replication-diagram.png></p>
<h5 id=组复制>组复制</h5>
<p><img src=./gr-replication-diagram.png></p>
<h4 id=mysql集群>Mysql集群 <a class=header-link href=#mysql%e9%9b%86%e7%be%a4><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4>
<p>InnoDB ReplicaSet 不提供 InnoDB Cluster 提供的所有功能，例如自动故障转移或多主模式。但是您可以手动切换或故障转移到辅助实例，例如在发生故障时。您甚至可以采用现有的复制部署，然后将其作为 InnoDB ReplicaSet 进行管理。</p>
<p>mysql集群主要基于 MySQL Group Replication构建，提供自动成员管理、容错、自动故障转移等功能。</p>
<p><img src=./innodb_cluster.png></p>
<h3 id=4环境准备>4.环境准备 <a class=header-link href=#4%e7%8e%af%e5%a2%83%e5%87%86%e5%a4%87><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3>
<h4 id=41环境目录结构>4.1.环境目录结构 <a class=header-link href=#41%e7%8e%af%e5%a2%83%e7%9b%ae%e5%bd%95%e7%bb%93%e6%9e%84><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4>
<pre tabindex=0><code>├─mysql-8.0.27-winx64
├─master
│  └─data
│  └─my.ini
├─slave_1
│  └─data
│  └─my.ini
└─slave_2
│  └─data
│  └─my.ini
└─slave_canal
│  ├─bin
│  ├─conf
│  ├─lib
│  ├─logs
│  │  ├─canal
│  │  └─example
│  └─plugin
</code></pre><h4 id=42安装mysql>4.2.安装mysql <a class=header-link href=#42%e5%ae%89%e8%a3%85mysql><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4>
<p>下载<code>https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-8.0.27-winx64.zip</code></p>
<h5 id=421master>4.2.1.master</h5>
<h6 id=1配置myini>1).配置my.ini <a class=header-link href=#1%e9%85%8d%e7%bd%aemyini><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h6>
<pre tabindex=0><code>[mysql]
# 设置mysql客户端默认字符集
default-character-set=utf8mb4

[mysqld]
# 设置3307端口
port = 3307
# 设置mysql的安装目录
basedir=E:/db/mysql_cluster/mysql-8.0.27-winx64
# 设置 mysql数据库的数据的存放目录，MySQL 8+ 不需要以下配置，系统自己生成即可，否则有可能报错
datadir=E:/db/mysql_cluster/master/data
# 允许最大连接数
max_connections=200
# 服务端使用的字符集默认为8比特编码的latin1字符集
character-set-server=utf8mb4
# 创建新表时将使用的默认存储引擎
default-storage-engine=INNODB
explicit_defaults_for_timestamp=true
log-error=E:/db/mysql_cluster/master/error.log
pid-file=E:/db/mysql_cluster/master/mysql.pid
socket =E:/db/mysql_cluster/master/mysql.socket

# master配置
server-id = 1
log_bin = E:/db/mysql_cluster/master/bin.log
max_binlog_size = 20M
slow_query_log = 1
#(可选配置）要同步的数据库名，要同步多个数据库，就多加几个replicate-db-db=数据库名
binlog-do-db=test
#（可选配置）要忽略的数据库
binlog-ignore-db=mysql
binlog-ignore-db=sys
binlog-ignore-db=information_schema
binlog-ignore-db=performance_schema
</code></pre><h6 id=2安装mysql>2).安装mysql <a class=header-link href=#2%e5%ae%89%e8%a3%85mysql><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h6>
<pre tabindex=0><code>
1.创建配置文件
2.cmd初始化
&gt;&gt;E:/db/mysql_cluster/mysql-8.0.27-winx64/bin/mysqld --defaults-file=E:/db/mysql_cluster/master/my.ini --initialize --basedir=E:/db/mysql_cluster/mysql-8.0.27-winx64 --datadir=E:/db/mysql_cluster/master/data

3.cmd运行
&gt;&gt;E:/db/mysql_cluster/mysql-8.0.27-winx64/bin/mysqld  --defaults-file=E:/db/mysql_cluster/master/my.ini

4.修改密码
查看 mster/error.log 临时密码，连接mysql修改root密码

&gt;&gt;E:/db/mysql_cluster/mysql-8.0.27-winx64/bin/mysql -h localhost -P 3307 -u root -p
&gt;&gt;use mysql;
&gt;&gt;alter user &#39;root&#39;@&#39;localhost&#39; identified with mysql_native_password by &#39;123456&#39;;
&gt;&gt;flush privileges; 
&gt;&gt;exit;
</code></pre><h6 id=3配置slave用户>3).配置slave用户 <a class=header-link href=#3%e9%85%8d%e7%bd%aeslave%e7%94%a8%e6%88%b7><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h6>
<p>创建slaveuser，允许从slave节点连接复制binlog。</p>
<p>授予所有权限<code>GRANT ALL PRIVILEGES ON *.* TO 'canal'@'%' </code></p>
<pre tabindex=0><code>mysql&gt;CREATE USER slaveuser@&#39;%&#39; IDENTIFIED WITH mysql_native_password BY &#39;123456&#39;;
mysql&gt;grant replication slave on *.* to slaveuser@&#39;%&#39;;
mysql&gt;GRANT SELECT, REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO &#39;slaveuser&#39;@&#39;%&#39;;
mysql&gt;flush privileges;
mysql&gt;show grants for slaveuser@&#39;%&#39;;
</code></pre><h6 id=4查看master状态>4).查看master状态 <a class=header-link href=#4%e6%9f%a5%e7%9c%8bmaster%e7%8a%b6%e6%80%81><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h6>
<pre tabindex=0><code>mysql&gt; show master status；
</code></pre><p><img src=/article/db/mysql-master-slave/1.png></p>
<h5 id=422slave>4.2.2.slave</h5>
<p>参考 <a href=https://dev.mysql.com/doc/refman/8.0/en/replication-options-replica.html rel=external>https://dev.mysql.com/doc/refman/8.0/en/replication-options-replica.html</a> slave配置参数</p>
<h6 id=1配置myini-1>1).配置my.ini <a class=header-link href=#1%e9%85%8d%e7%bd%aemyini-1><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h6>
<pre tabindex=0><code>[mysql]
# 设置mysql客户端默认字符集
default-character-set=utf8mb4

[mysqld]
# 设置 3308 端口
port = 3308
# 设置mysql的安装目录
basedir=E:/db/mysql_cluster/mysql-8.0.27-winx64
# 设置 mysql数据库的数据的存放目录，MySQL 8+ 不需要以下配置，系统自己生成即可，否则有可能报错
datadir=E:/db/mysql_cluster/slave_1/data
# 允许最大连接数
max_connections=200
# 服务端使用的字符集默认为8比特编码的latin1字符集
character-set-server=utf8mb4
# 创建新表时将使用的默认存储引擎
default-storage-engine=INNODB
explicit_defaults_for_timestamp=true
log-error=E:/db/mysql_cluster/slave_1/error.log
pid-file=E:/db/mysql_cluster/slave_1/mysql.pid
socket =E:/db/mysql_cluster/slave_1/mysql.socket

# master配置
log_bin = E:/db/mysql_cluster/slave_1/bin.log
server-id = 2
read_only = 1
max_binlog_size = 20M
slow_query_log   = 1
#(可选配置）要同步的数据库名，要同步多个数据库，就多加几个replicate-db-db=数据库名
binlog-do-db=test
#（可选配置）要忽略的数据库
binlog-ignore-db=mysql
binlog-ignore-db=sys
binlog-ignore-db=information_schema
binlog-ignore-db=performance_schema
</code></pre><h6 id=2安装mysql-1>2）.安装mysql <a class=header-link href=#2%e5%ae%89%e8%a3%85mysql-1><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h6>
<p>参考maseter</p>
<h6 id=3配置slave>3).配置slave <a class=header-link href=#3%e9%85%8d%e7%bd%aeslave><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h6>
<p>参考 master【查看master状态】</p>
<pre tabindex=0><code># 配置连接master信息
mysql&gt; CHANGE MASTER TO MASTER_HOST=&#39;127.0.0.1&#39;, master_port = 3307,MASTER_USER=&#39;slaveuser&#39;, MASTER_PASSWORD=&#39;123456&#39;, MASTER_LOG_FILE=&#39;bin.000001&#39;, MASTER_LOG_POS=1673,master_connect_retry = 15,master_retry_count = 0;
mysql&gt; start slave;
mysql&gt; show slave status;

# 删除slave配置信息
# stop slave;
# reset slave all;
</code></pre><p>创建只读用户，防止用root操作同步库</p>
<pre tabindex=0><code>CREATE USER &#39;readuser&#39;@&#39;%&#39; IDENTIFIED WITH mysql_native_password BY &#39;123456&#39;; 
GRANT SELECT ON *.* TO &#39;readuser&#39;@&#39;%&#39;;
FLUSH PRIVILEGES;
</code></pre><h6 id=4查看master状态-1>4).查看master状态 <a class=header-link href=#4%e6%9f%a5%e7%9c%8bmaster%e7%8a%b6%e6%80%81-1><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h6>
<pre tabindex=0><code>mysql&gt; show master status；
</code></pre><p><img src=/article/db/mysql-master-slave/2.png></p>
<h4 id=43-测试>4.3 测试 <a class=header-link href=#43-%e6%b5%8b%e8%af%95><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4>
<p>在master执行一下语句，查看slave库是否同步。</p>
<pre tabindex=0><code>CREATE DATABASE IF NOT EXISTS test DEFAULT CHARSET utf8 COLLATE utf8_general_ci;`

create table t_data
(
   id     bigint(20) not null auto_increment comment &#39;主键&#39;,
   name   varchar(32) comment &#39;名称&#39;,
   create_time          datetime default CURRENT_TIMESTAMP comment &#39;创建时间&#39;,
   update_time          datetime default CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP comment &#39;更新时间&#39;,
   primary key (id)
) ENGINE=InnoDB  COMMENT=&#39;测试表&#39;;

insert into t_data(name) values(1);
</code></pre><h3 id=5开启gtid>5.开启GTID <a class=header-link href=#5%e5%bc%80%e5%90%afgtid><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3>
<p>全局事务标识符 (GTID) 是在源服务器（源）上创建并与提交的每个事务相关联的唯一标识符。此标识符不仅对于它起源的服务器是唯一的，而且对于给定复制拓扑中的所有服务器也是唯一的。</p>
<p>从MySQL5.6开始增加了强大的GTID（Global Transaction ID，全局事务ID）这个特性，用来强化数据库的主备一致性， 故障恢复， 以及容错能力。用于取代过去传统的主从复制（即：基于binlog和position的异步复制）。</p>
<p>借助GTID，在发生主备切换的情况下，MySQL的其他slave可以自动在新主上找到正确的复制位置，这大大简化了复杂复制拓扑下集群的维护，也减少了人为设置复制position发生误操作的风险。另外，基于GTID的复制可以忽略已经执行过的事务，减少了数据发生不一致的风险。</p>
<p>参考：https://dev.mysql.com/doc/refman/8.0/en/replication-mode-change-online-enable-gtids.html</p>
<pre tabindex=0><code>1.修改master、slave 节点my.conf or my.ini
# GTID
gtid_mode=ON
enforce_gtid_consistency=ON

2.设置salve节点
mysql&gt; E:/db/mysql_cluster/mysql-8.0.27-winx64/bin/mysql -h localhost -P 3308 -u root -p
mysql&gt; STOP SLAVE ;
mysql&gt; CHANGE MASTER TO MASTER_HOST=&#39;127.0.0.1&#39;, master_port = 3307,MASTER_USER=&#39;slaveuser&#39;, MASTER_PASSWORD=&#39;123456&#39;,MASTER_AUTO_POSITION = 1;
mysql&gt; START SLAVE ;

Or from MySQL 8.0.22 / 8.0.23:

STOP REPLICA ;
CHANGE REPLICATION SOURCE TO MASTER_HOST=&#39;127.0.0.1&#39;, master_port = 3307,MASTER_USER=&#39;slaveuser&#39;, MASTER_PASSWORD=&#39;123456&#39;,SOURCE_AUTO_POSITION = 1;
START REPLICA ;

3.查看状态
show slave status \G;
show variables like &#39;gtid_%&#39;;
</code></pre><h3 id=6canal-slave>6.canal slave <a class=header-link href=#6canal-slave><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3>
<h4 id=61下载-canal>6.1下载 canal <a class=header-link href=#61%e4%b8%8b%e8%bd%bd-canal><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4>
<p><code>https://github.com/alibaba/canal/releases</code></p>
<h4 id=62-配置>6.2 配置 <a class=header-link href=#62-%e9%85%8d%e7%bd%ae><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4>
<pre tabindex=0><code>1）确认mysql配置
[mysqld]  
log-bin=mysql-bin #添加这一行就ok  
binlog-format=ROW #选择row模式   

mysql&gt; show variables like &#39;binlog_format&#39;;
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| binlog_format | ROW   |
+---------------+-------+
mysql&gt; show variables like &#39;log_bin&#39;;
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| log_bin       | ON    |
+---------------+-------+

2）解压到目录./slave_canal

3) 修改配置 slave_canal/conf/example/instance.properties
# 基础配置
canal.port = 11111 #端口
canal.serverMode = tcp   # canal client的模式: tcp kafka rocketMQ

# 配置destinations
canal.destinations = instance_1 # 指定实例    
canal.conf.dir = ../conf  # 实例配置目录
canal.auto.scan = true   # 自动扫描实列目录,实现实列动态加载、移除
canal.auto.scan.interval = 5 
canal.auto.reset.latest.pos.mode = false
canal.instance.tsdb.spring.xml = classpath:spring/tsdb/h2-tsdb.xml
canal.instance.global.mode = spring
canal.instance.global.lazy = false
canal.instance.global.manager.address = ${canal.admin.manager} 
canal.instance.global.spring.xml = classpath:spring/file-instance.xml 

4) 修改配置 slave_canal/conf/instance_1/instance.properties
canal.instance.master.address=127.0.0.1:3307 #指向mysql master配置
canal.instance.dbUsername=slaveuser   # 拥有主从复制、连接权限的用户
canal.instance.dbPassword=123456  # 对应dbUsername的密码

5) 启动 slave_canal、bin/startup.bat
slave_canal/logs/canal/canal.log
slave_canal/logs/instance_1/instance_1.log


 
</code></pre><h4 id=51-canal客户端测试>5.1 canal客户端测试 <a class=header-link href=#51-canal%e5%ae%a2%e6%88%b7%e7%ab%af%e6%b5%8b%e8%af%95><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4>
<p>see <code>https://github.com/alibaba/canal.git</code></p>
<pre tabindex=0><code>运行 com.alibaba.otter.canal.example.BaseCanalClientTest.main
</code></pre><p>在master节点执行 insert,可以看到bingnlog消息</p>
<p><img src=./canal_1.png></p>
<p>在master节点执行 update,可以看到bingnlog消息</p>
<p><img src=./canal_2.png></p>
<h3 id=7问题>7.问题 <a class=header-link href=#7%e9%97%ae%e9%a2%98><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3>
<h4 id=71error_code-1032-handler-error-ha_err_key_not_found-the-events-master-log-first-end_log_pos-429-error_code-my-001032>7.1.Error_code: 1032; handler error HA_ERR_KEY_NOT_FOUND; the event&rsquo;s master log FIRST, end_log_pos 429, Error_code: MY-001032 <a class=header-link href=#71error_code-1032-handler-error-ha_err_key_not_found-the-events-master-log-first-end_log_pos-429-error_code-my-001032><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4>
<pre tabindex=0><code>在从库删除数据后，出现主从同步问题
1)stop slave;
2)找出被删除的记录，重新插入从库
E:/db/mysql_cluster/mysql-8.0.27-winx64/bin/mysqlbinlog --no-defaults --base64-output=decode-rows -v  bin.000001 &gt;bin.sql

or

E:/db/mysql_cluster/mysql-8.0.27-winx64/bin/mysqlbinlog --no-defaults  --base64-output=DECODE-ROWS -v  bin.000001

3)start slave;

 
</code></pre><h4 id=72client-does-not-support-authentication-protocol-requested-by-server-consider-upgrading-mysql-client>7.2.client does not support authentication protocol requested by server consider upgrading mysql client <a class=header-link href=#72client-does-not-support-authentication-protocol-requested-by-server-consider-upgrading-mysql-client><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4>
<p>创建用户时指定mysql_native_password ， mysql8之后,加密规则是caching_sha2_password。</p>
<p><code>CREATE USER slaveuser@'%' IDENTIFIED WITH mysql_native_password BY '123456';</code></p>
<h4 id=73access-denied-you-need-at-least-one-of-the-super-replication-client-privileges>7.3.Access denied; you need (at least one of) the SUPER, REPLICATION CLIENT privilege(s) <a class=header-link href=#73access-denied-you-need-at-least-one-of-the-super-replication-client-privileges><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4>
<p>为用户增加 REPLICATION CLIENT 权限</p>
<p><code>GRANT SELECT, REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO '用户名'@'%';</code></p>
<h3 id=8备查命令>8.备查命令 <a class=header-link href=#8%e5%a4%87%e6%9f%a5%e5%91%bd%e4%bb%a4><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3>
<h4 id=81查看从节点数量>8.1.查看从节点数量 <a class=header-link href=#81%e6%9f%a5%e7%9c%8b%e4%bb%8e%e8%8a%82%e7%82%b9%e6%95%b0%e9%87%8f><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4>
<pre tabindex=0><code>show slave hosts;
select * from information_schema.processlist as p where p.command = &#39;Binlog Dump&#39;; 
</code></pre><h4 id=82查看版本>8.2.查看版本 <a class=header-link href=#82%e6%9f%a5%e7%9c%8b%e7%89%88%e6%9c%ac><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h4>
<p><code>select version();</code></p>
<p><code>SELECT * FROM information_schema.plugins;</code>
<code>SELECT @@innodb_version;</code></p>
<h5 id=82mysqlbinlog>8.2.mysqlbinlog</h5>
<p>查看binlog信息 <code>mysqlbinlog -v --base64-output=DECODE-ROWS ./bin.000001</code></p>
<p>查看binglog文件 <code>SHOW BINARY LOGS</code></p>
<h3 id=9数据参考>9.数据参考: <a class=header-link href=#9%e6%95%b0%e6%8d%ae%e5%8f%82%e8%80%83><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3>
<p>1.机器信息<code>DB型(内存(12*32G)384G硬盘2*480G(s4500)SSD+8*960G(s4500)SSD)</code></p>
<pre tabindex=0><code>show variables like &#39;%binlog%&#39;;
1	binlog_cache_size	1048576
2	binlog_checksum	NONE
3	binlog_direct_non_transactional_updates	OFF
4	binlog_error_action	ABORT_SERVER
5	binlog_format	ROW
6	binlog_group_commit_sync_delay	0
7	binlog_group_commit_sync_no_delay_count	0
8	binlog_gtid_simple_recovery	ON
9	binlog_max_flush_queue_time	0
10	binlog_order_commits	ON
11	binlog_row_image	FULL
12	binlog_rows_query_log_events	OFF
13	binlog_skip_flush_commands	OFF
14	binlog_space_limit	0
15	binlog_stmt_cache_size	32768
16	binlog_transaction_dependency_history_size	25000
17	binlog_transaction_dependency_tracking	COMMIT_ORDER
18	encrypt_binlog	OFF
19	have_backup_safe_binlog_info	YES
20	innodb_api_enable_binlog	OFF
21	innodb_locks_unsafe_for_binlog	OFF
22	log_statements_unsafe_for_binlog	ON
23	max_binlog_cache_size	18446744073709547520
24	max_binlog_files	0
25	max_binlog_size	1073741824
26	max_binlog_stmt_cache_size	18446744073709547520
27	sync_binlog	1




show variables like &#39;%relay%&#39;;
1	max_relay_log_size	0
2	relay_log	relay-bin
3	relay_log_basename	/data/mysql_3306/relay-bin
4	relay_log_index	/data/mysql_3306/relay-bin.index
5	relay_log_info_file	relay-log.info
6	relay_log_info_repository	TABLE
7	relay_log_purge	ON
8	relay_log_recovery	ON
9	relay_log_space_limit	0
10	sync_relay_log	10000
11	sync_relay_log_info	10000
</code></pre>
</div>
<h2>See also</h2>
<ul>
<li><a href=/article/db/mysql-master-slave/>mysql master-slave</a></li>
<li><a href=/article/db/canal/>canal-mysql binlog日志解析</a></li>
<li><a href=/cn/article/db/canal/>canal-mysql binlog日志解析</a></li>
</ul>
</div>
</div>
<div id=right-sidebar class="order-2 w-20 dn db-l sticky pt2">
<aside class="right-0 f6 pv4 pv0-ns ph4-l nested-list-reset nested-copy-line-height">
<div class=nested-links>
<div date-pref>
<a href=https://qiaomingzi.github.io/cn/article/db/canal/ class="dib f6 pl1 hover-bg-light-gray br-100" title="canal-mysql binlog日志解析 ">
<svg class="fill-current" height="30" viewBox="0 0 24 24" width="30" xmlns="http://www.w3.org/2000/svg"><path d="M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"/><path d="M0 0h24v24H0z" fill="none"/></svg>
</a>
</div>
</div>
</aside>
</div>
</div>
</article>
<div id=page-footer class="w-100 bg-light-gray">
<div class="mw7 pa4 center nested-lh-copy lh-copy">
<h6 class="f6 dark-gray mb2">
Last updated: June 26, 2024: <a class="hide-child link primary-color" href=https://github.com/gohugoio/hugoDocs/commit/5eddda97267cd6f518d1b23be788c571c8011e7d>chore:add 信息系统项目管理师 (5eddda9)</a>
</h6>
<a href=https://github.com/gohugoio/hugoDocs/edit/master/content/cn/cn/article/DB/mysql-master-slave/index.md class="f6 ph3 pv1 br2 dib tc ttu mv3 bg-primary-color white hover-bg-green link">Improve this page</a>
</div>
</div>
</main>
<footer class="bg-primary-color-dark ph4-ns pt4 relative w-100" role=contentinfo>
<div class="center flex-ns flex-wrap justify-between mw9 w-90">
<div class="pb3 pt4 w-100 w-50-ns">
<div class="b f3 light-gray mb3 nested-links tc">
李明梓-BLOG<br>
</div>
<div class="center w4">
<img src=/images/hugo-logo-wide.svg alt="Hugo Logo">
</div>
</div>
<div class="w-100 w-50-l light-gray"> 
本文仅为个人笔记,作为学习使用,如有雷同请联系作者 mingzi.li 处理,mail: qiaomingzi100@sina.com
</div>
</div>
</footer>
</body>
</html>